<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Virtual Mart - Vehicles</title>

    <!-- Bootstrap + Oberlo CSS -->
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <link rel="stylesheet" type="text/css" href="../css/responsive.css">
    <link rel="stylesheet" type="text/css" href="../css/mart.css">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,500,600,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>

    <!-- header -->
    <header class="header_section">
        <div class="container">
            <nav class="navbar navbar-expand-lg custom_nav-container">
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navbarSupportedContent">
                    <span class=""></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item active"><a class="nav-link" href="../index.html">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="">About</a></li>
                        <li class="nav-item"><a class="nav-link navbar-brand"
                                href="../virtual-mart/index.html"><span><span>Virtual</span>Mart</span></a></li>
                        <li class="nav-item"><a class="nav-link" href="../blog/blog.html">Blog</a></li>
                        <li class="nav-item"><a class="nav-link" href="../contact/contact.html">Contact</a></li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>

    <!-- hero section -->
    <div class="banner_section layout_padding">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-md-6 text-center text-md-left">
                    <div class="banner_taital_main">
                        <h1 class="banner_taital">Virtual<br> Vehicle Mart</h1>
                        <p class="banner_text">Search from hundreds of vehicles — filter by make, model, year, engine
                            size and more.</p>
                    </div>
                </div>
                <div class="col-md-6 padding_right0 text-center">
                    <div class="banner_img"><img src="../images/banner-img.png" alt="hero vehicle"></div>
                </div>
            </div>
        </div>
    </div>


    <div class="search_wrapper">
        <div class="container">
            <div class="search_card">
                <form id="searchForm" class="row g-3">
                    <div class="col-12 col-sm-6 col-md-3">
                        <label class="form-label small">Make</label>
                        <input type="text" class="form-control" placeholder="e.g. Toyota" name="make">
                    </div>
                    <div class="col-12 col-sm-6 col-md-3">
                        <label class="form-label small">Model</label>
                        <input type="text" class="form-control" placeholder="e.g. Corolla" name="model">
                    </div>
                    <div class="col-6 col-md-2">
                        <label class="form-label small">Year</label>
                        <input type="number" class="form-control" placeholder="Year" name="year">
                    </div>
                    <div class="col-6 col-md-2">
                        <label class="form-label small">Engine (cc)</label>
                        <input type="number" class="form-control" placeholder="e.g. 1800" name="enginesize">
                    </div>
                    <div class="col-12 col-md-2 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">Search</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- search results -->
    <div class="blog_section layout_padding">
        <div class="container">
            <div class="row mb-4 align-items-center">
                <div class="col-md-6">
                    <h1 class="blog_taital">Search Results</h1>
                </div>
                <div class="col-md-6 text-right">
                    <select id="sortBy" class="form-control w-auto d-inline-block">
                        <option value="">Sort by</option>
                        <option value="price">Price</option>
                        <option value="date">Date Added</option>
                        <option value="year">Model Year</option>
                    </select>
                </div>
            </div>

            <div class="blog_section_2">
                <div class="row" id="resultsGrid">
                    <!-- JS will load vehicles here -->
                </div>
            </div>
        </div>
    </div>

    <!-- stats section -->
    <div class="choose_section_2">
        <div class="container">
            <div class="row text-center">
                <div class="col-lg-3 col-sm-6">
                    <h1 class="rated_text">3700</h1>
                    <p class="house_text">Happy Clients</p>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <h1 class="rated_text">5700</h1>
                    <p class="house_text">Vehicles In Stock</p>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <h1 class="rated_text">124</h1>
                    <p class="house_text">Awards</p>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <h1 class="rated_text">704</h1>
                    <p class="house_text">Dealer Branches</p>
                </div>
            </div>
        </div>
    </div>

    <!-- footer -->
    <div class="copyright_section">
        <div class="container text-center">
            <p class="copyright_text">
                2025 &copy; All Rights Reserved. Design by Victor Micheni
            </p>
        </div>
    </div>

    <!-- JS -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/popper.min.js"></script>
    <script src="../js/bootstrap.bundle.min.js"></script>
    <script src="../js/plugin.js"></script>
    <script src="../js/custom.js"></script>

    <!-- Load vehicles logic -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const grid = document.getElementById('resultsGrid');
            const form = document.getElementById('searchForm');
            let vehicles = [];

            function render(list) {
                grid.innerHTML = '';
                if (!list.length) {
                    grid.innerHTML = '<div class="col-12 text-center text-muted">No vehicles found.</div>';
                    return;
                }

                list.forEach((v, index) => {
                    const carouselId = `carousel${v.id || index}`;
                    const images = v.images && v.images.length ? v.images : ["../images/default.png"];

                    grid.innerHTML += `
        <div class="col-md-4 mb-4">
          <div class="blog_box h-100 d-flex flex-column">
            <div id="${carouselId}" class="carousel slide" data-ride="carousel" data-interval="3000">
              <ol class="carousel-indicators">
                ${images.map((_, i) => `
                  <li data-target="#${carouselId}" data-slide-to="${i}" ${i === 0 ? 'class="active"' : ''}></li>
                `).join('')}
              </ol>
              <div class="carousel-inner">
                ${images.map((img, i) => `
                  <div class="carousel-item ${i === 0 ? 'active' : ''}">
                    <img class="d-block w-100" src="${img}" alt="${v.make} ${v.model}">
                  </div>
                `).join('')}
              </div>
              ${images.length > 1 ? `
                <a class="carousel-control-prev" href="#${carouselId}" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#${carouselId}" role="button" data-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>` : ''}
            </div>
            <div class="btn_main">
              <div class="date_text"><a href="#">$${v.price.toLocaleString()}</a></div>
            </div>
            <h3 class="blog_text">${v.make} ${v.model}</h3>
            <p class="lorem_text">${v.year} — ${v.engineSize} — ${v.transmission} — ${v.color}</p>
            <ul class="list-unstyled mt-2 small">
              <li><strong>Model Code:</strong> ${v.modelCode}</li>
              <li><strong>Engine:</strong> ${v.engineSize}</li>
            </ul>
            <div class="mt-auto read_bt">
              <a href="vehicle.html?id=${v.id}">View Details
                <span class="arrow_icon"><i class="fa fa-long-arrow-right" aria-hidden="true"></i></span>
              </a>
            </div>
          </div>
        </div>`;
                });
            }

            function applySearch() {
                const formData = new FormData(form);
                const make = formData.get('make').toLowerCase();
                const model = formData.get('model').toLowerCase();
                const year = formData.get('year');
                const enginesize = formData.get('enginesize');

                let filtered = vehicles.filter(v => {
                    return (!make || v.make.toLowerCase().includes(make)) &&
                        (!model || v.model.toLowerCase().includes(model)) &&
                        (!year || v.year == year) &&
                        (!enginesize || v.engineSize == enginesize);
                });
                render(filtered);
            }

            // hook into niceSelect change
            $(document).on('change', '#sortBy', function () {
                let sorted = [...vehicles];
                const value = $(this).val();
                if (value === 'price') sorted.sort((a, b) => a.price - b.price);
                if (value === 'date') sorted.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded));
                if (value === 'year') sorted.sort((a, b) => b.year - a.year);
                render(sorted);
            });

            form.addEventListener('submit', e => {
                e.preventDefault();
                applySearch();
            });

            fetch('vehicles.json')
                .then(res => res.json())
                .then(data => {
                    vehicles = data;
                    render(vehicles);
                });
        });
    </script>


</body>

</html>